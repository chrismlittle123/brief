# Brief - V1 Specification

> Fill in the gaps, keep it brief.

A streamlined weekly status update application that uses AI to convert voice or text updates into professionally formatted reports, automatically saved to Notion.

## Tech Stack

- **Frontend**: Next.js 16 (App Router), React 19, TypeScript, Tailwind CSS 4
- **AI**: OpenAI (Whisper for transcription, GPT-4 mini for report generation)
- **Storage**: Notion (database + pages)
- **Notifications**: Slack (via webhook)
- **Hosting**: Vercel
- **Infrastructure**: Pulumi (dev/prod)
- **Monorepo**: pnpm workspaces (`packages/frontend`, `packages/backend`)

## Features

### 1. Dual Input Methods

**Voice Update** (`/checkin`):
- Record audio answers to 4 questions via browser microphone
- OpenAI Whisper API transcription
- Editable transcript before report generation
- Spacebar toggle for hands-free recording
- Real-time waveform visualization

**Text Update** (`/checkin/text`):
- Direct text input for the same 4 questions
- Progress indicator showing filled questions

### 2. The 4 Core Questions

1. "What did you get done this week?"
2. "Any challenges? How did you handle them?"
3. "What's the plan for next week?"
4. "How's the client/stakeholder feeling?"

### 3. AI-Powered Report Generation

Transforms raw responses into structured reports containing:

- **TL;DR**: 2-sentence executive summary
- **This Week**: Organized list of accomplishments
- **Challenges**: Issues with context and resolutions
- **Next Week**: Planned priorities
- **Client Pulse**: Stakeholder sentiment summary
- **Status**: "On Track" / "At Risk" / "Blocked"

### 4. Report Refinement

- Natural language modification requests (e.g., "Add that I also fixed a bug...")
- AI re-generates sections while preserving context
- Chat-like interface for iterative edits

### 5. Notion Integration

- Saves completed reports to a Notion database
- Creates formatted pages with:
  - Title: "Weekly Update - [Date]"
  - Properties: Status, Week Of date, Person (employee email)
  - Structured sections matching the report format
- Returns link to view the saved Notion page

### 6. Team Authentication

- Email-based authentication (no password)
- Whitelist-controlled access via `ALLOWED_EMAILS` environment variable
- Cookie-based sessions (7-day expiry)
- Middleware-based route protection

### 7. Shame Bot (Team Accountability)

- Automated check of Notion database for weekly submissions
- Identifies missing updates by team member
- 3-level escalation system:
  - **GENTLE** (Friday 4pm): Light reminder
  - **MEDIUM** (Sunday 6pm): More urgent
  - **FULL_ROAST** (Monday 8am): Maximum drama
- AI-generated witty messages with film/TV references
- Posts to Slack via webhook
- Celebrates when everyone submits on time

## API Routes

| Route | Method | Purpose |
|-------|--------|---------|
| `/api/auth/login` | POST | Authenticate with email |
| `/api/auth/me` | GET | Check current auth status |
| `/api/auth/logout` | POST | Clear session |
| `/api/transcribe` | POST | Convert audio to text (Whisper) |
| `/api/generate-report` | POST | Generate AI report from responses |
| `/api/refine-report` | POST | Update report based on user instruction |
| `/api/save-to-notion` | POST | Create Notion page with report |
| `/api/shame-bot` | GET/POST | Check submissions and post to Slack |
| `/api/health` | GET | Health check |

## User Flow

1. **Landing Page** (`/`): Welcome with feature cards and CTA buttons
2. **Login** (`/login`): Email-based authentication
3. **Choose Input Method**: Voice or Text
4. **Record/Enter Responses**: Answer 4 questions
5. **Review & Edit**: Check transcript/responses, re-record if needed
6. **AI Report Generation**: System generates structured report
7. **Refine** (optional): Make corrections via natural language
8. **Save to Notion**: One-click save with success confirmation
9. **View in Notion**: Link to open newly created page

## Design

- Tailwind CSS with custom design tokens (primary, secondary, destructive, success)
- Geist Sans (primary font) + Sacramento (decorative cursive for branding)
- Custom components using Class Variance Authority (CVA)
- Lucide React icons
- Smooth transitions, pulse effects, spinner animations
- Mobile-first responsive design

## Environment Variables

| Variable | Purpose |
|----------|---------|
| `OPENAI_API_KEY` | Whisper transcription and GPT report generation |
| `NOTION_API_KEY` | Notion database access |
| `NOTION_DATABASE_ID` | Target Notion database ID |
| `ALLOWED_EMAILS` | Comma-separated authorized email addresses |
| `SLACK_WEBHOOK_URL` | Shame bot Slack notifications |
